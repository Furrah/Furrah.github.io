<!doctype html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="generator" content="Hugo 0.59.0" />
  
  <link rel="stylesheet" href="https://furrah.github.io/css/bootstrap.min.css">
  
  
  <title>Interfacing with FTDIs FT4222H USB 2.0 to Quad SPI / I2C Bridge IC</title>
  <style>
.container {
  max-width: 800px;
}
#nav a {
  font-weight: bold;
  color: inherit;

}
#nav-border {
  border-bottom: 1px solid #212529;
}
#main {
  margin-top: 1em;
  margin-bottom: 4em;
}
#home-jumbotron {
  background-color: inherit;
}
.font-125 {
  font-size: 125%;
}
.tag-btn {

  margin-bottom: 0.3em;
}
img {
  max-width: 100%;
}
.btn {
  margin-bottom: 0.3em;
  margin-right : 0.3em;

}

 


a {
  color: #007bff;
 }  



.w3-table,.w3-table-all{border-collapse:collapse;border-spacing:0;width:100%;display:table}.w3-table-all{border:1px solid #ccc}

.w3-table-all tr:nth-child(odd){background-color:#fff}.w3-table-all tr:nth-child(even){background-color:#f1f1f1}

.w3-card-4,.w3-hover-shadow:hover{box-shadow:0 4px 10px 0 rgba(0,0,0,0.2),0 4px 20px 0 rgba(0,0,0,0.19)}

.w3-bordered tr,.w3-table-all tr{border-bottom:1px solid #ddd}.w3-striped tbody tr:nth-child(even){background-color:#f1f1f1}

.w3-hoverable tbody tr:hover,.w3-ul.w3-hoverable li:hover{background-color:#ccc}.w3-centered tr th,.w3-centered tr td{text-align:center}

.w3-table td,.w3-table th,.w3-table-all td,.w3-table-all th{padding:8px 8px;display:table-cell;text-align:left;vertical-align:top}

.w3-table th:first-child,.w3-table td:first-child,.w3-table-all th:first-child,.w3-table-all td:first-child{padding-left:16px}

 


</style>
  <script type="text/javascript" async
  src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });
  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script>
</head>  
  <body>
        <div id="nav-border" class="container">
  <nav id="nav" class="nav justify-content-center">
   
    
    
    <a class="nav-link" href="/"><i data-feather="home"></i> Home</a>
   
    
    
    <a class="nav-link" href="/electronics/"><i data-feather="cpu"></i> Electronics</a>
   
    
    
    <a class="nav-link" href="/food/"><i data-feather="heart"></i> Food</a>
   
    
    
    <a class="nav-link" href="/photography/"><i data-feather="aperture"></i> Photography</a>
   
    
    
    <a class="nav-link" href="/misc/"><i data-feather="coffee"></i> Misc</a>
   
    
    
    <a class="nav-link" href="/tags/"><i data-feather="tag"></i> Tags</a>
  
  </nav>
</div> 
        
    <div class="container">
      <main id="main">
      

<h1>Interfacing with FTDIs FT4222H USB 2.0 to Quad SPI / I2C Bridge IC</h1>


<i data-feather="calendar"></i> <time datetime="2020-05-23">May 23, 2020</time>

<br><br>


<p>A tutorial for interfacing with FTDIs FT4222H USB 2.0 to Quad SPI / I2C Bridge IC on macOS</p>

<h2 id="setup">Setup</h2>

<p>Download the relevent drivers for the IC</p>

<p>D2XX Drivers: <a href=https://www.ftdichip.com/Drivers/D2XX.htm target="_blank">FTD2XX</a></p>

<p>FT4222H Driver: <a href=https://www.ftdichip.com/Products/ICs/FT4222H.html target="_blank">FT4222H</a></p>

<ol>
<li>Open D2XX1.4.16.dmg and copy the D2XX folder to your desktop</li>

<li><p>Inside we are interested in 3 files:</p>

<ul>
<li>ftd2xx.h</li>
<li>WinTypes.h</li>
<li>libftd2xx.1.14.16.dylib</li>
</ul></li>

<li><p>Open a terminal and navigate to the D2XX folder on your desktop</p></li>

<li><p>Move .h files to /usr/local/include</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mv ftd2xx.h WinTypes.h /usr/local/include </code></pre></div></li>

<li><p>Move &lsquo;.dylib&rsquo; file to /usr/local/lib</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mv libftd2xx.1.14.16.dylib /usr/local/lib </code></pre></div></li>

<li><p>Create second folder on Desktop and copy contents of libft4222.1.4.4.14.dmg to it</p></li>

<li><p>move <code>libft4222.1.4.4.14.dylib</code> to /usr/local/lib</p></li>

<li><p>move files <code>libboost_system.dylib</code> and <code>libboost_thread-mt.dylib</code> located in boost_libs to /usr/local/lib</p></li>

<li><p>move <code>libft4222.h</code> to /usr/local/include</p></li>

<li><p>Create symbolic links for <code>libft4222.1.4.4.14.dylib</code> and <code>libftd2xx.1.4.16.dylib</code></p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo -ln -sf /usr/local/lib/libft4222.1.4.4.14.dylib /usr/local/lib/libft4222.dylib
sudo -ln -sf /usr/local/lib/libftd2xx.1.4.16.dylib /usr/local/lib/libftd2xx.dylib</code></pre></div></li>
</ol>

<h4 id="notes-on-installing">Notes on installing</h4>

<p>If using a device with standard FTDI vendor and product identifiers, install D2xxHelper to prevent mac OS from claiming the device as a serial port (locking out D2XX programs). This will prevent the device being used with the VCP driver as a standard COM port. D2xxHelper can be found here : <a href=https://www.ftdichip.com/Drivers/D2XX/MacOSX/D2xxHelper_v2.0.0.pkg target="_blank">D2xxHelper</a></p>

<h2 id="testing">Testing</h2>

<h4 id="1-find-chip-version">1. Find chip version</h4>

<p>Inside libft4222.1.4.4.14.dmg is a folder called examples with a .c file called <code>get-version.c</code>.
using the following command</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cc get-version.c -lft4222 -lftd2xx  -Wl,-L/usr/local/lib -o version.out</code></pre></div>
<p>If compilation has gone well and all libraries have been found <code>version.out</code> will have been made.
execute using</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">./version.out</code></pre></div>
<p>This should return something similar to this</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Device <span style="color:#40a070">0</span>: <span style="color:#4070a0">&#39;FT4222 A&#39;</span>
  Chip version: <span style="color:#40a070">42220400</span>, LibFT4222 version: <span style="color:#40a070">01040409</span></code></pre></div>
<h3 id="2-accessing-eeprom">2. Accessing EEPROM</h3>

<p>Create a folder in the root directory of D2XX called <code>build</code> and move <code>libftd2xx.a</code> into it.</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir build
mv libftd2xx.a build</code></pre></div>
<p>now navigate to the folder <code>Samples</code></p>

<p>Inside the D2XX folder navigate to the folder samples and execute <code>make</code></p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">make</code></pre></div>
<p>once this has complete navigate to D2XX/Samples/EEPROM/read and exectute read</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">./read</code></pre></div>
<p>This should return something similar to this</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#bb60d5">Signature1</span> <span style="color:#666">=</span> <span style="color:#40a070">0</span>
<span style="color:#bb60d5">Signature2</span> <span style="color:#666">=</span> -1
<span style="color:#bb60d5">Version</span> <span style="color:#666">=</span> <span style="color:#40a070">0</span>
<span style="color:#bb60d5">VendorId</span> <span style="color:#666">=</span> 0x0403
<span style="color:#bb60d5">ProductId</span> <span style="color:#666">=</span> 0x601C
<span style="color:#bb60d5">Manufacturer</span> <span style="color:#666">=</span> FTDI
<span style="color:#bb60d5">ManufacturerId</span> <span style="color:#666">=</span>
<span style="color:#bb60d5">Description</span> <span style="color:#666">=</span> FT4222
<span style="color:#bb60d5">SerialNumber</span> <span style="color:#666">=</span>
<span style="color:#bb60d5">MaxPower</span> <span style="color:#666">=</span> <span style="color:#40a070">100</span>
<span style="color:#bb60d5">PnP</span> <span style="color:#666">=</span> <span style="color:#40a070">1</span>
<span style="color:#bb60d5">SelfPowered</span> <span style="color:#666">=</span> <span style="color:#40a070">0</span>
<span style="color:#bb60d5">RemoteWakeup</span> <span style="color:#666">=</span> <span style="color:#40a070">1</span>
Returning <span style="color:#40a070">0</span></code></pre></div>
<h3 id="3-using-cmake">3. Using Cmake</h3>

<p>Navigate to the examples folder as before containing <code>get-version.c</code><br>
Create a directory called <code>build</code></p>

<p>create a text file called <code>CMakeLists.txt</code></p>

<p>inside add the following</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">cmake_minimum_required(VERSION 3.17.2)

project (FT4222H_test)

set ( PROJECT_LINK_LIBS libft4222.dylib libftd2xx.dylib )
link_directories ( ~/work/CERN/FTDI/example/build /usr/local/lib)

include_directories ( /usr/local/include )

add_executable( FT4222H_Version get-version.c ) 
target_link_libraries( FT4222H_Version ${PROJECT_LINK_LIBS} )</code></pre></div>
<p>This tells the compiler where to find our files and links them to the project
inside link directories replace the first directory with the location of your build folder.
navigate to the build folder and run</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cmake ..
make</code></pre></div>
<p>The file <code>FT4222H_Version</code> should now be built.</p>

<p>execute with</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">./FT4222H_Version</code></pre></div>
<p>and again the following should be returned</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Device <span style="color:#40a070">0</span>: <span style="color:#4070a0">&#39;FT4222 A&#39;</span>
  Chip version: <span style="color:#40a070">42220400</span>, LibFT4222 version: <span style="color:#40a070">01040409</span></code></pre></div>




      </main>

    </div>
    
<script src="https://furrah.github.io/js/feather.min.js"></script>
<script>
  feather.replace()
</script>    
  </body>
</html>